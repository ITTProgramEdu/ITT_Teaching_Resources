# Exercise1: Line Tracking

## 问题出处

本次练习的代码出自2024年中控杯智能小车对抗赛“疑悟队”，没有额外改动，只挖去直走部分的代码留给各位补全。建议各位不要去阅读这份屎山代码💩，根据目标函数的输入输出进行代码的补全即可。本人在挖代码的过程看着凌乱的代码已然回想起当时不太正常的精神状态☠️。

## 所需工具

需要各位在自己电脑上进行`Arduino`代码的补全或改写。在本地完成代码的编译后，上传至小车的`Arduino`开发板。直接使用工作室的小车，在基地场地进行调试即可。

具体操作请询问`@布拉奇 @旺仔大馒头`。后续有时间也会在本文档更新相关操作。

## 问题描述

根据传感器获取的信息，调整左右车轮的速度，使小车沿白线直走。

本练习**仅得到一份可运行的代码非常简单**，不过要让小车稳定直走还需要一定工作量进行调试。

待补全的函数位于`src/Straight.cpp`，内容如下所示，一些必要的解释也已经在代码中写出。

```c++
void Straight_Go1(unsigned int inspect12,double normal1,double current_angle)
{
  /* 
      用于处理巡线时直走情况的函数

      函数输入inspect12，normal1，current_angle三个变量

      没有输出，将直接使用 Set_Motor_Speed 函数调整车轮速度

      inspect12：0 ~ 4095的一个整数，将其转化为二进制数则对应12个传感器的状态，1代表检测到白色，2代表检测到黑色。其中前7位为小车前方7个传感器，后5位为后方5个传感器。
      normal1：当前的速度，前进为正，后退为负，前进时一般在30~50.
      current_angle：与直线的夹角（即偏离路线的角度），逆时针为正，顺时针为负。单位为弧度制，也即当current_angle=0时，车头正对直线,当current_angle=pi/4时，车头向左偏了45度。

      Set_Motor_Speed(左轮速度，右轮速度)：将左右轮速度调节到合适的速度。例如
      Set_Motor_Speed(normal1,normal1)将使车轮保持原速度不变。
      Set_Motor_Speed(normal1*0.1,normal1*0.1)。速度变为原来的0.1倍。
  */

  unsigned int inspect = inspect12 >> 5;
  unsigned int inspect_back=inspect12 & 31; 
  // 以上两个语句将前后方传感器分离开来
  // 运用位运算 如 & | 等可以方便二进制数的数据处理

  /*----------------在下方编写你的代码---------------------*/





  Set_Motor_Speed(normal1,normal1);  // 此语句需要修改，放置此处起提醒作用
  /*----------------在上方编写你的代码---------------------*/
  return;
}
```

建议忽略该文件中定义了的一堆乱七八糟的变量，我也不太记得那是用来干什么的。不过如果你想从中找到一些启发也可以，但不是很必要。

## 预期成果

- 一份补全的可编译的代码
- 一段小车稳定直行的视频

对于该练习有任何疑问可以联系`@布拉奇 @旺仔大馒头`。
